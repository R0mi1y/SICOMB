{% extends 'base/footer.html' %}
{% load static %}

{% block css %}{% static 'css/register_police_form.css' %}{% endblock %}
{% block title %}SICOMB - Registro de Equipamento{% endblock title %}
{% block title_top %}REGISTRO DE EQUIPAMENTO{% endblock title_top %}

{% block content_final %}
<section class="section_register shadow">
  <div class="registration shadow box-form">
    <table>
        <thead>
            <tr>
                <th colspan="100%" class="title"><h3>FORMULÁRIO DE CADASTRO</h3></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="sub-title">FORMULÁRIO</td>
            </tr>
        </tbody>   
    </table>
    <div class="row_color"><span><hr></span></div>
    
    <form method="post" action="." enctype="multipart/form-data" class="form-element" id="form-equipment">
      <div class="input-div">
        {% csrf_token %}
        {% for field in form %}
            {% if field.name == "image_path" %}
                <div class="input-box">
                    <h4 class="input-title {% if field.errors %}input-error{% endif %}">{{ field.label }}</h4>
                    <div class="file-div">
                        <label class="file-label" for="{{ field.id_for_label }}">UPLOAD DE ARQUIVO +</label>
                        <input class="input-file" name="{{ field.name }}" type="file" id="{{ field.id_for_label }}" accept="image/*">
                    </div>
                </div>
            {% elif field.name == "matricula" %}
                <div class="input-box">
                    <h4 for="{{ field.id_for_label }}" class="input-title {% if field.errors %}input-error{% endif %}">{{ field.label }}</h4>
                    <div class="input-search">
                        {{ field }}
                        {% comment %} <button type="button" onclick="search()"><img src="{% static 'img/search.png'%}"
                            alt="Procurar"></button> {% endcomment %}
                    </div>
                </div>
            {% else %}
                <div class="input-box">
                    <h4 for="{{ field.id_for_label }}" class="input-title {% if field.errors %}input-error{% endif %}">{{ field.label }}</h4>
                    {{ field }}
                </div>
            {% endif %}
        {% endfor %}
        <div class="finalize-registration">
          <label><input type="submit" class="box-shadow-registration" value="Enviar"></label>
        </div>
      </div> 
    </form>
  </div>
</section>

<script>
    function search() {
        var matriculaInput = document.querySelector('#matricula-input');
        var matricula = matriculaInput.value;
        if (matricula != '') {
            window.location.href = '/police/search/' + matricula + '/';
        } else {
            var messageText = "Insira uma matrícula";
            // Crie um elemento de alerta para cada mensagem
            popUp(messageText, {timer: 2000, overlay: false});
        }
    }
    $(document).ready(function () {
        let timer = 2000;
        {% for field in form %}
            {% if field.errors %}
                {% for error in field.errors %}
                    popUp("{{ error }}", {timer: timer, overlay: false});
                    timer += 1000;
                {% endfor %}
            {% endif %}
        {% endfor %}
    });
</script>
{% endblock content_final %}







